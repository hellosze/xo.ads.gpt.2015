/* xo.ads.gpt 1.10.8 updated: 2015-03-23*/
"use strict";var XO=XO||{};XO.ads=XO.ads||{};var googletag=googletag||{};googletag.cmd=googletag.cmd||[],XO.ads.version="1.10.8",XO.ads.gpt=function(){return{page_metadata:{},hide_ads:!1,adSlots:["null"],setAdBackgrounds:function(){googletag.pubads().addEventListener("slotRenderEnded",function(a){var b=document.getElementById(a.slot.b.d);270!==b.clientHeight&&110!==b.clientHeight&&(b.parentNode.className=b.parentNode.className.replace(/ad-container /g,""))})},retrieveMetadata:function(){try{var a;this.page_metadata["device-type"]=window.innerWidth>768?"desktop":"mobile";var b=new RegExp(/page=(\d{1,5})/),c=document.location.search.match(b);this.page_metadata.page=null!==c?c[1]:1;var d=new RegExp(/(wedding-categories|wedding-activities|ceremony-types)/);if(this.page_metadata["page-type"]=XO.metadata.page_data.kind,"results"===XO.metadata.page_data.kind)for(var e in XO.metadata.page_data.results_terms.terms)XO.metadata.page_data.results_terms.terms.hasOwnProperty(e)&&(this.page_metadata[e]=XO.metadata.page_data.results_terms.terms[e],null!==e.match(d)&&(a=e.replace(/-/g,"_"),this.page_metadata[a]=XO.metadata.page_data.results_terms.terms[e]));if("detail"===XO.metadata.page_data.kind||"fashion"===XO.metadata.application.name&&XO.metadata.page_data.kind)for(var f in XO.metadata.entities[XO.metadata.entities.primary_entity_id].terms)XO.metadata.entities[XO.metadata.entities.primary_entity_id].terms.hasOwnProperty(f)&&(this.page_metadata[f]=XO.metadata.entities[XO.metadata.entities.primary_entity_id].terms[f],null!==f.match(d)&&(a=f.replace(/-/g,"_"),this.page_metadata[a]=XO.metadata.entities[XO.metadata.entities.primary_entity_id].terms[f]),"category_name"===f&&(this.page_metadata["wedding-categories"]=XO.metadata.entities[XO.metadata.entities.primary_entity_id].terms[f],this.page_metadata.wedding_categories=XO.metadata.entities[XO.metadata.entities.primary_entity_id].terms[f]));"fashion"===XO.metadata.application.name&&delete this.page_metadata.description,"content"===XO.metadata.application.name&&(this.page_metadata.sid=XO.metadata.entities[XO.metadata.entities.primary_entity_id].url.split("/").slice(-1))}catch(g){"Cannot read property 'application' of undefined"===g.message&&"?gpt_console"===document.location.search&&console.log("XO.metadata is undefined"),"Cannot read property 'kind' of undefined"===g.message&&"?gpt_console"===document.location.search&&console.log("XO.metadata.page_data is undefined"),"Cannot read property 'primary_entity_id' of undefined"===g.message&&"?gpt_console"===document.location.search&&console.log("XO.metadata.entities is undefined"),"Cannot read property 'terms' of undefined"===g.message&&"?gpt_console"===document.location.search&&console.log("XO.metadata.entities.primary_entity_id is undefined")}},initialize:function(){var a="https:"==document.location.protocol,b=(a?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";document.write('<script src="'+b+'"></script>'),this.retrieveMetadata()},addSlot:function(a){if(this.hide_ads===!1){var b=XO.metadata.application.name,c=a.width,d=a.height,e=document.getElementsByTagName("script"),f=a.idSelector||e[e.length-1].parentNode.id,g=this.page_metadata;googletag.cmd.push(function(){var e=googletag.defineSlot("/4879/"+b+".n_TK",[c,d],f);e.setTargeting("adsize",[c+"x"+d,"native"]);var h=a.targeting;if("undefined"!==h)for(var i=0,j=h.length;j>i;i++){var k=h[i];e.setTargeting(k[0],k[1])}if("undefined"!=typeof this.page_metadata)for(var l in g){var m=l.replace(/-/g,"_");e.setTargeting(m,g[l])}googletag.pubads().enableSyncRendering(),e.addService(googletag.pubads()),googletag.enableServices(),googletag.display(f)})}},refreshAdSlot:function(a,b){"undefined"!==b?(XO.ads.gpt.adSlots[a].setTargeting(b[0],b[1]),googletag.pubads().refresh([XO.ads.gpt.adSlots[a]])):googletag.pubads().refresh([XO.ads.gpt.adSlots[a]])},addAsyncSlot:function(a){if(this.hide_ads===!1)try{var b=XO.metadata.application.name,c=a.sizes||[a.width,a.height],d=document.getElementsByTagName("script"),e=a.idSelector||d[d.length-1].parentNode.id,f=this.page_metadata,g=this.adSlots;googletag.cmd.push(function(){var d=googletag.defineSlot("/4879/"+b+".n_TK",c,e),h=a.targeting,i=document.getElementById(e).getBoundingClientRect().top+1;(950>i&&window.innerWidth>768||1800>i&&window.innerWidth<768)&&d.setTargeting("premium","true"),(i>950&&window.innerWidth>768||i>1800&&window.innerWidth<768)&&d.setTargeting("premium","false");for(var j=0,k=h.length;k>j;j++){var l=h[j];d.setTargeting(l[0],l[1])}for(var m in f)d.setTargeting(m,f[m]);if(g.push(d),d.addService(googletag.pubads()),a.sync===!0&&googletag.pubads().enableSyncRendering(),googletag.enableServices(),googletag.display(e),a.postRenderCallback&&"function"==typeof a.postRenderCallback&&googletag.pubads().addEventListener("slotRenderEnded",function(b){return b.isEmpty||b.slot!==d?a.postRenderCallback(e,!1):a.postRenderCallback(e,!0)}),"real-weddings"===XO.metadata.application.name||"fashion"===XO.metadata.application.name){var n;XO.metadata.page_data.kind&&(n="detail page"),1===document.querySelectorAll("[data-filter-count]").length&&(n="filtered results page"),0===document.querySelectorAll("[data-filter-count]").length&&(n="unfiltered results page"),analytics.track("DFP Impression",{product:XO.metadata.application.name,platform:"web",url:document.location.href,source:n})}})}catch(h){"?gpt_console"===document.location.search&&console.log(h.message)}}}}(),XO.ads.gpt.initialize();